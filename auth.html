<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>35 лет вместе</title>
    <link rel="preload" href="./fonts/Akrobatbold.woff2" as="font" type="font/woff2" crossorigin="anonymous" />
    <link rel="preload" href="./fonts/Akrobatsemibold.woff2" as="font" type="font/woff2" crossorigin="anonymous" />
    <link rel="preload" href="./fonts/Akrobatextrabold.woff2" as="font" type="font/woff2" crossorigin="anonymous" />
    <link rel="preload" href="./fonts/Verdana-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous" />
    <link rel="preload" href="./fonts/Verdana-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous" />
    <link rel="stylesheet" href="./css/swiper-bundle.min.css" />
    <link rel="stylesheet" href="./css/main.min.css?v=1" />
</head>

<body>
    <div class="auth-modal">
        <div class="auth-modal__content">
            <div class="auth-modal__head">
                Авторизация
            </div>
            <form class="auth-form">
                <label class="auth-modal__field">
                    <span>Ваш табельный номер</span>
                    <input type="number" placeholder="00000000" class="auth-modal__input" name="personnel-number">
                    <div class="error-message">Неправильный табельный номер</div>
                </label>
                <button class="auth-submit-btn" type="submit">Войти</button>
            </form>
        </div>
    </div>
    <script src="./js/jquery.min.js"></script>
    <script>
        const authForm = document.querySelector('.auth-form');
        const personnelNumber = authForm.querySelector('.auth-modal__input');
        const errField = authForm.querySelector('.error-message');
        const authModalField = authForm.querySelector('.auth-modal__field');


        personnelNumber.addEventListener('input', (e) => {
            authModalField.classList.remove('err');
        })
        authForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const personnelNumberValue = personnelNumber.value.trim();
            if (personnelNumberValue.length < 1) {
                errField.innerHTML = "Поле не может быть пустым";
                authModalField.classList.add('err');
                return;
            }
            $.ajax({
                type: 'POST',
                url: 'someUrl',
                dataType: 'json',
                data: {
                    personnelNumber: personnelNumberValue
                },
                success: function (data) {

                    if (data.success) {
                        window.location.reload();
                    }
                    if (data.error) {
                        errField.innerHTML = "Неправильный табельный номер";
                        authModalField.classList.add('err');
                    }
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    // Eсли ошибка, выводим ошибку
                    errField.innerHTML = "Что то пошло не так, попробуйте позднее";
                    authModalField.classList.add('err');

                }
            });
        });
    </script>
</body>

</html>